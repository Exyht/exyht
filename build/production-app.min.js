function addCss(a){try{var b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.innerHTML=a,b.appendChild(c)}catch(d){return}}window.Exyht=Ember.Application.create({currentPath:""}),Exyht.deferReadiness(),Exyht.BaseURL="/blog/",Exyht.currentBaseUri=window.location.protocol+"//"+window.location.hostname+Exyht.BaseURL,Exyht.gravatarVersion="identicon";var currentDate=new Date;Exyht.currentYear=currentDate.getFullYear(),$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}),Ember.Handlebars.helper("format-markdown",function(a){function b(a){return/^https?:\/\//.test(a)?a:void 0}if("undefined"!=typeof a){var c=new Markdown.getSanitizingConverter;return emoji.sheet_path=Exyht.PathToLibraries+"/libraries/js/sheet_twitter_72.png",emoji.use_sheet=!0,emoji.include_title=!0,emoji.init_env(),new Ember.Handlebars.SafeString(emoji.replace_colons(html_sanitize(c.makeHtml(a),b)))}}),Ember.Handlebars.helper("format-date",function(a){return timezone=jstz.determine(),timezoneName=timezone.name(),moment.tz(a,timezoneName).fromNow()}),Ember.Handlebars.helper("format-archive-date",function(a){return moment(a).format("DD MMM YYYY")}),Ember.Handlebars.helper("format-comment-number",function(a){return 1==a?" Comment":" Comments"}),Exyht.Router.map(function(){this.route("index",{path:Exyht.BaseURL}),this.route("post",{path:Exyht.BaseURL+"post/:post_slug/:post_id"})}),Exyht.Router.reopen({location:"history"}),Exyht.IndexRoute=Ember.Route.extend({model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"getBlogPosts").then(function(a){return a})},redirect:function(){this.transitionTo("index")}}),Exyht.PostRoute=Ember.Route.extend({model:function(a){return Ember.$.getJSON(Exyht.currentBaseUri+"getPostTitle/"+a.post_id).then(function(a){return $("title").html(a.title),a})},setupController:function(a,b){Ember.$.getJSON(Exyht.currentBaseUri+"postComments/"+b.id).then(function(b){Ember.run(function(){a.set("model",b)}),$("title").html(b.title)})},serialize:function(a){var b=a.title.substring(0,60).replace(/[^A-Za-z0-9\s+]/g,"").replace(/\s+/g,"-").toLowerCase();return{post_slug:b,post_id:a.id}}}),Exyht.AutoExpandingTextAreaComponent=Ember.TextArea.extend({didInsertElement:function(){Ember.run.next(function(){function a(a){var c;c=a.match(/`{3,}/g),c&&c.length%2?b=!0:(c=a.match(/`/g),b=c&&c.length%2?!0:!1)}var b=!1;this.$().focus(),this.$().textcomplete([{match:/\B:([\-+\w]*)$/,search:function(a,b){b($.map(emojies,function(b){return 0===b.indexOf(a)?b:null}))},template:function(a){return new Ember.Handlebars.SafeString(emoji.replace_colons(":"+a.toLowerCase()+":")+" :"+a+":")},replace:function(a){return":"+a+": "},index:1,context:function(c){return a(c),!b}},{match:/\b(\w{2,})$/,search:function(a,b){b($.map(words,function(b){return 0===b.indexOf(a)?b:null}))},index:1,replace:function(a){return a+" "},context:function(){return b}}]),this.$().scroll(function(){var a=$(this).scrollTop();0===a?a=a:a+=5,$("div#typingCommentDiv").stop().animate({scrollTop:a},500)})}.bind(this))}}),Exyht.ApplicationController=Ember.ArrayController.extend({needs:"post",isReplying:!1,isHideAddComment:!1,isCommentDivShown:!1,sendingCommentOn:!1,actualTitleForAddComment:"",actualPostIdForAddComment:"",actualOnlyCurrentSlug:"",newCurrentComment:"",newCommentLength:"",showNewCommentLength:!1,currentCommentIdToReply:"",currentCommenterNameToReply:"",currentCommenterGravaterToReply:"",valueForSpam:"",postKey:function(){var a=this.get("typeComment").length,b=Math.abs(20-a);0===a||20>a?this.set("showNewCommentLength",!0):this.set("showNewCommentLength",!1),this.set("newCommentLength",b)}.observes("typeComment"),hasLogo:function(){return Ember.get("Exyht.BlogSettings.has_logo")}.property("Exyht.BlogSettings.has_logo"),blogLogo:function(){var a=Ember.get("Exyht.BlogSettings.logo");return""!==a?a:""}.property("Exyht.BlogSettings.logo"),blogTitle:function(){return Ember.get("Exyht.BlogSettings.blog_title")}.property("Exyht.BlogSettings.blog_title"),blogSubTitle:function(){return Ember.get("Exyht.BlogSettings.blog_sub_title")}.property("Exyht.BlogSettings.blog_sub_title"),bodyBgColor:function(){var a=Ember.get("Exyht.BlogStyle.body_bg_clr");return""!==a?"background-color: "+a:"background-color: #ffffff"}.property("Exyht.BlogStyle.body_bg_clr"),readOnlyMode:function(){return Ember.get("Exyht.BlogSettings.isReadOnlyMode")}.property("Exyht.BlogSettings.isReadOnlyMode"),commentFeature:function(){return Ember.get("Exyht.BlogSettings.hasCommentFeature")}.property("Exyht.BlogSettings.hasCommentFeature"),hasNavbar:function(){return Ember.get("Exyht.BlogSettings.hasNavbar")}.property("Exyht.BlogSettings.hasNavbar"),blogLinks:function(){return Ember.get("Exyht.BlogLinks")}.property("Exyht.BlogLinks"),navBgColor:function(){var a=Ember.get("Exyht.BlogStyle.nav_bg_clr");return""!==a?"background-color: "+a:"background-color: #428bca"}.property("Exyht.BlogStyle.nav_bg_clr"),currentYear:function(){return Ember.get("Exyht.currentYear")}.property("Exyht.currentYear"),footerBgColor:function(){var a=Ember.get("Exyht.BlogStyle.footer_bg_clr");return""!==a?"background-color: "+a:""}.property("Exyht.BlogStyle.footer_bg_clr"),sidebarBgColor:function(){var a=Ember.get("Exyht.BlogStyle.sidebar_bg_clr");return""!==a?"background-color: "+a:"background-color: #ffffff"}.property("Exyht.BlogStyle.sidebar_bg_clr"),sidebarAuthor:function(){return Ember.get("Exyht.SidebarInfo.sidebar_info.author")}.property("Exyht.SidebarInfo.sidebar_info.author"),sidebarArchive:function(){return Ember.get("Exyht.SidebarInfo.sidebar_info.archive")}.property("Exyht.SidebarInfo.sidebar_info.archive"),actions:{addComment:function(){var a=this.get("name"),b=this.get("typeComment"),c=this.get("actualPostIdForAddComment"),d=this.get("email"),e=this.get("currentCommentIdToReply"),f=this.get("valueForSpam");if(!b||b.length<20||!a||!d)return this.set("isCommentDivShown",!0),!1;if(b.trim()){this.set("sendingCommentOn",!0);var g=this;$.post(Exyht.BaseURL+"addComment",{postId:c,comment:b,name:a,email:d,spam_bot:f,replyToCommentId:e},function(c){if($('meta[name="csrf-token"]').remove(),$("head").append('<meta name="csrf-token" content="'+c.token+'">'),$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}),"saved"==c.controller_response){g.set("isCommentDivShown",!1);var d=CryptoJS.MD5(g.get("email").trim().toLowerCase()),e=g.get("currentCommenterNameToReply"),f=g.get("currentCommenterGravaterToReply");g.get("newCurrentComment").pushObject(g.get("isReplying")===!0?{name:a,email:d,comment:b,replyToComment:Ember.Object.create({commentHasReply:!0,name:e,email:f})}:{name:a,email:d,comment:b,replyToComment:[]}),g.set("name",""),g.set("email",""),g.set("typeComment",""),g.set("actualPostIdForAddComment",""),g.set("actualTitleForAddComment",""),g.set("actualOnlyCurrentSlug",""),g.set("isReplying",!1),g.set("currentCommentIdToReply",""),g.set("currentCommenterNameToReply",""),g.set("currentCommenterGravaterToReply","")}else 1===c.read_only_mode?($("#showError").addClass("alert alert-danger"),$("#showError").html(c.controller_response)):$("#showError").html(c.error_msg);g.set("sendingCommentOn",!1)},"json")}},cancelAddComment:function(){var a=this.get("typeComment");if("undefined"==typeof a||0===a.length)this.set("name",""),this.set("email",""),this.set("isCommentDivShown",!1),this.set("actualPostIdForAddComment",""),this.set("actualTitleForAddComment",""),this.set("actualOnlyCurrentSlug",""),this.set("isReplying",!1),this.set("currentCommentIdToReply",""),this.set("currentCommenterNameToReply",""),this.set("currentCommenterGravaterToReply","");else{var b=confirm("Want to cancel?");b===!0&&(this.set("name",""),this.set("email",""),this.set("typeComment",""),this.set("isCommentDivShown",!1),this.set("actualPostIdForAddComment",""),this.set("actualTitleForAddComment",""),this.set("actualOnlyCurrentSlug",""),this.set("isReplying",!1),this.set("currentCommentIdToReply",""),this.set("currentCommenterNameToReply",""),this.set("currentCommenterGravaterToReply",""))}},hideAddComment:function(){var a=this.get("typeComment");"undefined"==typeof a||0===a.length?(this.set("isCommentDivShown",!1),this.set("isHideAddComment",!1),this.set("name",""),this.set("email",""),this.set("actualPostIdForAddComment",""),this.set("actualTitleForAddComment",""),this.set("actualOnlyCurrentSlug",""),this.set("isReplying",!1),this.set("currentCommentIdToReply",""),this.set("currentCommenterNameToReply",""),this.set("currentCommenterGravaterToReply","")):(this.set("isCommentDivShown",!1),this.set("isHideAddComment",!0),$("div.container-full").css({"margin-top":"50px"}))},showAddComment:function(){this.set("isCommentDivShown",!0),this.set("isHideAddComment",!1),$("div.container-full").css({"margin-top":"0"})},insertBold:function(){var a=$("textarea");a.val(a.val()+" **bold** ")},insertItalic:function(){var a=$("textarea");a.val(a.val()+" *italic* ")},insertLink:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"[Link description](http://example.com)":a.val()+"\n [Link description](http://example.com)")},insertQuote:function(){var a=$("textarea");a.val(a.val()+"\n > your quote here")},insertCode:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"`For inline code` \n\n	For pre code":a.val()+"\n\n`For inline code` \n\n	For pre code")},insertOrderedlist:function(){var a=$("textarea");a.val(a.val()+"Indent one space after the dot '.'\n\n1. Ordered list1\n2. Ordered list2")},insertUnorderedlist:function(){var a=$("textarea");a.val(a.val()+"Indent one space after the + or -.\n\n- Unordered list1\n	+ Nested list")},insertHorizontalrule:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"-----\nNew line":a.val()+"\n\n-----\nNew line")},insertStrikethrough:function(){var a=$("textarea");a.val(a.val()+"<del>Strike through</del>")},insertSubscript:function(){var a=$("textarea");a.val(a.val()+"Sub<sub>script</sub>")},insertSuperscript:function(){var a=$("textarea");a.val(a.val()+"Sub<sup>script</sup>")},insertHeading1:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"# Heading1\n":a.val()+"\n# Heading1\n")},insertHeading2:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"## Heading2\n":a.val()+"\n## Heading2\n")},insertHeading3:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"### Heading3\n":a.val()+"\n### Heading3\n")}}}),Exyht.CommentsController=Ember.ObjectController.extend({needs:["application","post"],commentFeature:Ember.computed.oneWay("controllers.application.commentFeature"),readOnlyMode:Ember.computed.oneWay("controllers.application.readOnlyMode"),addReplyCommentBtn:Ember.computed.alias("controllers.application.isCommentDivShown"),getIsHideAddComment:Ember.computed.alias("controllers.application.isHideAddComment"),setIsReplying:Ember.computed.alias("controllers.application.isReplying"),actualPostId:Ember.computed.alias("controllers.application.actualPostIdForAddComment"),actualPostIdFromPostController:Ember.computed.alias("controllers.post.id"),newComment:Ember.computed.alias("controllers.application.newCurrentComment"),getCommentsArrayFromPostController:Ember.computed.alias("controllers.post.comments"),setcommentIdToReply:Ember.computed.alias("controllers.application.currentCommentIdToReply"),setcommenterNameToReply:Ember.computed.alias("controllers.application.currentCommenterNameToReply"),setcommenterGravaterToReply:Ember.computed.alias("controllers.application.currentCommenterGravaterToReply"),addActualTitle:Ember.computed.alias("controllers.application.actualTitleForAddComment"),addOnlyCurrentSlug:Ember.computed.alias("controllers.application.actualOnlyCurrentSlug"),actions:{replyToCommentTrue:function(){this.set("addReplyCommentBtn",!0),this.set("getIsHideAddComment",!1),this.set("setIsReplying",!0);var a=this.get("actualPostIdFromPostController");this.set("actualPostId",a);var b=this.get("getCommentsArrayFromPostController");this.set("newComment",b);var c=this.get("id");this.set("setcommentIdToReply",c);var d=this.get("name");this.set("setcommenterNameToReply",d);var e=this.get("email");this.set("setcommenterGravaterToReply",e),this.set("addActualTitle",""),this.set("addOnlyCurrentSlug","")},flagComment:function(){var a=this.get("id"),b=this;$.ajax({type:"POST",url:Exyht.BaseURL+"flagComment",data:{commentId:a},success:function(){b.set("isFlagged",!0)}})}}}),Exyht.IndexController=Ember.ObjectController.extend({postBgColor:function(){var a=Ember.get("Exyht.BlogStyle.post_bg_clr");return""!==a?"background-color: "+a:"background-color: #ffffff"}.property("Exyht.BlogStyle.post_bg_clr")}),Exyht.PostController=Ember.ObjectController.extend({needs:["application","index"],postBgColor:Ember.computed.oneWay("controllers.index.postBgColor"),commentFeature:Ember.computed.oneWay("controllers.application.commentFeature"),readOnlyMode:Ember.computed.oneWay("controllers.application.readOnlyMode"),addCommentBtn:Ember.computed.alias("controllers.application.isCommentDivShown"),getIsHideAddComment:Ember.computed.alias("controllers.application.isHideAddComment"),getIsReplying:Ember.computed.alias("controllers.application.isReplying"),addActualTitle:Ember.computed.alias("controllers.application.actualTitleForAddComment"),addActualPostId:Ember.computed.alias("controllers.application.actualPostIdForAddComment"),addOnlyCurrentSlug:Ember.computed.alias("controllers.application.actualOnlyCurrentSlug"),newComment:Ember.computed.alias("controllers.application.newCurrentComment"),setcommentIdToReply:Ember.computed.alias("controllers.application.currentCommentIdToReply"),setcommenterNameToReply:Ember.computed.alias("controllers.application.currentCommenterNameToReply"),setcommenterGravaterToReply:Ember.computed.alias("controllers.application.currentCommenterGravaterToReply"),hasPost:function(){var a,b=this.get("model.id");return a="undefined"==typeof b||0===b?!1:!0}.property("model.id"),actions:{addCommentTrue:function(){this.set("addCommentBtn",!0),this.set("getIsHideAddComment",!1),this.set("getIsReplying",!1);var a=this.get("model.id"),b=this.get("model.title").substring(0,60),c=this.get("model.title").substring(0,60).replace(/[^A-Za-z0-9\s+]/g,"").replace(/\s+/g,"-").toLowerCase();this.set("addActualTitle",b),this.set("addActualPostId",a),this.set("addOnlyCurrentSlug",c);var d=this.get("model.comments");this.set("newComment",d),this.set("setcommentIdToReply",""),this.set("setcommenterNameToReply",""),this.set("setcommenterGravaterToReply","")}}}),Exyht.ApplicationView=Ember.View.extend({templateName:"application",ngravatarUrl:function(){return"http://www.gravatar.com/avatar/"+this.get("controller.currentCommenterGravaterToReply")+"?d="+Exyht.gravatarVersion+"&s=20"}.property("controller.currentCommenterGravaterToReply")}),Exyht.CommentsView=Ember.View.extend({templateName:"comments",cgravatarUrl:function(){return"http://www.gravatar.com/avatar/"+this.get("controller.email")+"?d="+Exyht.gravatarVersion+"&s=40"}.property("controller.email"),rgravatarUrl:function(){return"http://www.gravatar.com/avatar/"+this.get("controller.replyToComment.email")+"?d="+Exyht.gravatarVersion+"&s=18"}.property("controller.replyToComment.email")}),Exyht.PostView=Ember.View.extend({templateName:"post",postCreated:function(){return new Ember.Handlebars.SafeString(moment(this.get("controller.created")).format("MMM DD YYYY"))}.property("controller.created"),pageViewCount:function(){var a=parseInt(this.get("controller.views"));return new Ember.Handlebars.SafeString(0===a?"1 seen":a+1+" seen")}.property("controller.views")});