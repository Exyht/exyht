function showLoading(){var a=$("#loadingDiv");a.show()}function showImgLoading(){var a=$("#imgLoadingDiv");a.show()}window.Exyht=Ember.Application.create({currentPath:""}),Exyht.deferReadiness(),Exyht.BaseUrl="/blog/admin-page",Exyht.gravatarVersion="identicon",Exyht.hostnameWithProtocolPort=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),Exyht.blogUrl=Exyht.hostnameWithProtocolPort+"/blog",Exyht.currentBaseUri=Exyht.hostnameWithProtocolPort+Exyht.BaseUrl,$.ajaxSetup({headers:{"Admin-X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}),Ember.Handlebars.helper("format-markdown",function(a){function b(a){return/^https?:\/\//.test(a)?a:void 0}if("undefined"!=typeof a){var c=new Markdown.getSanitizingConverter;emoji.sheet_path=Exyht.hostnameWithProtocolPort+"/blog/libraries/js/sheet_twitter_72.png",emoji.use_sheet=!0,emoji.include_title=!0,emoji.init_env();var d=html_sanitize(a,b);return new Ember.Handlebars.SafeString(emoji.replace_colons(c.makeHtml(d)))}}),Ember.Handlebars.helper("format-xmarkdown",function(a){if("undefined"!=typeof a){var b=new Markdown.getSanitizingConverter;return new Ember.Handlebars.SafeString(emoji.replace_colons(b.makeHtml(a)))}}),Exyht.Router.map(function(){this.route("index",{path:Exyht.BaseUrl}),this.route("comment",{path:Exyht.BaseUrl+"/comment/:post_id"}),this.route("typeblogpost",{path:Exyht.BaseUrl+"/typeblogpost"}),this.route("profilesetting",{path:Exyht.BaseUrl+"/profilesetting"}),this.route("uisettings",{path:Exyht.BaseUrl+"/uisettings"}),this.route("imggallery",{path:Exyht.BaseUrl+"/imggallery"})}),Exyht.Router.reopen({location:"history"}),Exyht.IndexRoute=Ember.Route.extend({model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"/getBlogPosts").then(function(a){return a})},redirect:function(){this.transitionTo("index")},actions:{editPostTrue:function(){this.transitionTo("typeblogpost")},viewComments:function(a){this.transitionTo("comment",a.id)}}}),Exyht.CommentRoute=Ember.Route.extend({model:function(a){return Ember.$.getJSON(Exyht.currentBaseUri+"/getComments/"+a.post_id).then(function(a){return{comments:a}})}}),Exyht.ProfilesettingRoute=Ember.Route.extend({model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"/getProfileInfo").then(function(a){return a})}}),Exyht.ImggalleryRoute=Ember.Route.extend({init_galry_img_offset:0,init_galry_img_limit:15,model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"/getGalleryImg/"+this.init_galry_img_offset+"/"+this.init_galry_img_limit).then(function(a){return{images:a}})}}),Exyht.CheckVersionComponent=Ember.Component.extend({isNewVersion:!1,version:"",onInsert:function(){var a=this;$.getJSON(Exyht.blogUrl+"/package.json").then(function(b){a.set("version",b.version)}),setTimeout(function(){$.ajax({type:"GET",url:"http://exyht.github.io/exyht/info.json?callback=?",async:!1,jsonpCallback:"jsonCallback",contentType:"application/json",dataType:"jsonp",success:function(b){b.version!==a.get("version")&&a.setProperties({isNewVersion:!0,version:b.version})}})},1500)}.on("didInsertElement"),getVersion:function(){return this.get("version")?this.get("version"):void 0}.property("version")}),Exyht.CountPostsComponent=Ember.Component.extend({numberOfPost:function(){var a,b=this.get("posts").get("length");return a=1===b?"1 Post":b>1?b+" Posts":"No Post"}.property("posts")}),Exyht.EditorActionComponent=Ember.Component.extend({isSavingAsDraft:!1,isPublishing:!1,status:[{postStatus:"Publish",id:1},{postStatus:"Draft",id:0}],currentStatus:{id:1},actions:{createPost:function(a,b){var c=this.get("ntitle").trim(),d=this.get("nbody").trim(),e=this;return!c||c.length<5||!d||d.length<20?!1:(this.set(a,!0),console.log("Request: Sending request"),$.ajax({type:"POST",url:Exyht.BaseUrl+"/"+b,data:{title:c,body:d},success:function(b){console.log("Response: "+b),e.set(a,!1),e.setProperties({ntitle:"",nbody:""}),alert(b)}}))},createNew:function(){this.send("createPost","isPublishing","createNewPost")},createDraft:function(){this.send("createPost","isSavingAsDraft","createNewDraft")},saveProfileEdit:function(){var a=this.get("nbody").trim();console.log("Request: Sending request"),$.ajax({type:"POST",url:Exyht.BaseUrl+"/saveProfileEdit",data:{about:a},success:function(a){console.log("Response: "+a),alert(a)}})},cancelProfileEditing:function(){this.setProperties({isProfileEditingOn:!1,isEditingOn:!1,ntitle:"",nbody:"",postId:"",editOnForProfSetContr:!1})},saveEdit:function(a){var b=this.get("ntitle").trim(),c=this.get("nbody").trim(),d=this.get("currentStatus.id");return!b||this.get("ntitle").length<5||!c||this.get("nbody").length<20?!1:void $.ajax({type:"POST",url:Exyht.BaseUrl+"/saveEdit",data:{postId:a,title:b,body:c,status:d},success:function(a){console.log("Response: "+a),alert(a)}})},cancelEditing:function(){this.setProperties({isEditingOn:!1,ntitle:"",nbody:"",postId:""})}}}),Exyht.EditorToolsComponent=Ember.Component.extend({postKey:function(){var a=this.get("nbody").length,b=Math.abs(20-a);0===a||20>a?this.set("showNbodyLength",!0):this.set("showNbodyLength",!1),this.set("newBodyLength",b)}.observes("nbody"),actions:{ctv:function(a){var b=$("textarea");b.val(b.val()+a)},citv:function(a,b){var c=$("textarea");c.val(""===c.val()?c.val()+a:c.val()+b)},insertBold:function(){this.send("ctv"," **bold** ")},insertItalic:function(){this.send("ctv"," *italic* ")},insertLink:function(){this.send("citv","[Link description](http://example.com)","\n [Link description](http://example.com)")},insertQuote:function(){this.send("ctv","\n > your quote here")},insertCode:function(){this.send("citv","`For inline code` \n\n	For pre code","\n\n`For inline code` \n\n	For pre code")},imgTabStatus:function(){this.set("isImageTab",!0)},vidTabStatus:function(){this.set("isImageTab",!1)},ivtask:function(a){var b=$("textarea"),c=$("#"+a+"UrlTextField");if(""===c.val()){var d="image"==a?"![alt text](http://example.com/image.jpg)":"![isyoutube](Link to youtube)";b.val(b.val()+d)}else{var e="image"==a?"alt text":"isyoutube";b.val(b.val()+"!["+e+"]("+c.val()+")")}c.val("")},insertImage:function(){this.get("isImageTab")===!0?this.send("ivtask","image"):this.send("ivtask","video")},cancelUploadImage:function(){$("#loadingDiv").hide()},insertOrderedlist:function(){this.send("ctv","Indent one space after the dot '.'\n\n1. Ordered list1\n2. Ordered list2")},insertUnorderedlist:function(){this.send("ctv","Indent one space after the + or -.\n\n- Unordered list1\n	+ Nested list")},insertHorizontalrule:function(){this.send("citv","-----\nNew line","\n\n-----\nNew line")},insertStrikethrough:function(){this.send("ctv","<del>Strike through</del>")},insertSubscript:function(){this.send("ctv","Sub<sub>script</sub>")},insertSuperscript:function(){this.send("ctv","Sub<sup>script</sup>")},insertHeading1:function(){this.send("citv","# Heading1\n","\n# Heading1\n")},insertHeading2:function(){this.send("citv","# Heading2\n","\n# Heading2\n")},insertHeading3:function(){this.send("citv","# Heading3\n","\n# Heading3\n")},resetTextarea:function(){var a=$("textarea");a.val("")}}}),Exyht.GravatarImageComponent=Ember.Component.extend({size:30,email:"",notReply:!0,gravatarUrl:function(){var a=this.get("email"),b=this.get("size");return"http://www.gravatar.com/avatar/"+a+"?d="+Exyht.gravatarVersion+"&s="+b}.property("email","size")}),Exyht.ImageGalleryComponent=Ember.Component.extend({img_from:15,img_to:30,totalImgs:function(){var a=this.get("images").filterBy("img_visible",!0).get("length");return a>0?a:0}.property("images.@each.img_visible"),inInsert:function(){this.scheduleMasonry(),$(window).on("scroll",$.proxy(this.didScroll,this))}.on("didInsertElement"),onLeaving:function(){this.destroyMasonry(),this.setProperties({img_from:15,img_to:30}),$(window).off("scroll",$.proxy(this.didScroll,this))}.on("willDestroyElement"),scheduleMasonry:function(){Ember.run.scheduleOnce("afterRender",this,this.applyMasonry)}.observes("images.@each"),applyMasonry:function(){var a=$("#galleryContainer");a.imagesLoaded(function(){var b=a.data("masonry");if(b){b.reloadItems();var c=b.options.transitionDuration;b.options.transitionDuration=0,b.layout(),b.options.transitionDuration=c}else a.masonry({itemSelector:".item",columnWidth:150})})},destroyMasonry:function(){$("#galleryContainer").masonry("destroy")},didScroll:function(){$(window).scrollTop()+$(window).height()==$(document).height()&&Ember.run.debounce(this,this.loadPics,1e3)},loadPics:function(){var a=this.get("images"),b=this,c=this.get("img_from"),d=this.get("img_to");c<=this.get("totalImgs")+15&&$.getJSON(Exyht.currentBaseUri+"/getGalleryImg/"+c+"/"+d).then(function(c){b.set("img_from",b.get("img_to"));var e=parseInt(b.get("img_from"))+15;b.set("img_to",e),$.each(c,function(b){c[b].id!=d+1&&a.pushObject({id:c[b].id,src_path:c[b].src_path,img_visible:c[b].img_visible})})})}}),Exyht.LogOutComponent=Ember.Component.extend({actions:{logOut:function(){$.post(Exyht.BaseUrl+"/logout",function(a){"true"===a&&window.location.replace(Exyht.BaseUrl+"/login")})}}}),Exyht.ManageCommentComponent=Ember.Component.extend({banLoading:!1,flagLoading:!1,actions:{markAsSeen:function(){var a=this.get("cmt.id");this.set("cmt.isSeen",!0),$.ajax({type:"POST",url:Exyht.BaseUrl+"/markAsSeen/"+a,success:function(a){console.log("Marked as seen!"),alert(a)}})},removeComment:function(){this.set("cmt.showLoading",!0);var a=confirm("Want to remove?");if(a===!0){var b=this.get("cmt.id"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeComment/"+b,success:function(a){console.log(a),c.setProperties({"cmt.showLoading":!1,"cmt.isFlagged":!1,"cmt.status":!1}),alert(a)}})}else this.set("comment.showLoading",!1)},banIp:function(){this.set("banLoading",!0);var a=confirm("Want to ban this Ip address?");if(a===!0){var b=this.get("cmt.ip_address"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/banIp/"+b,success:function(a){console.log(a),c.setProperties({banLoading:!1,"cmt.ip_status":!0}),alert(a)}})}else this.set("banLoading",!1)},removeFlag:function(){this.set("flagLoading",!0);var a=confirm("Want to remove flag?");if(a===!0){var b=this.get("cmt.id"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeFlag/"+b,success:function(a){console.log(a),c.setProperties({flagLoading:!1,"cmt.isFlagged":!1}),alert(a)}})}else this.set("flagLoading",!1)}}}),Exyht.ManageImageComponent=Ember.Component.extend({deletingImg:!1,srcPath:function(){var a=this.get("img.src_path"),b=this.get("img.img_visible");return b===!0?Ember.get("Exyht.hostnameWithProtocolPort")+"/blog/upload_dir/"+a:void 0}.property("Exyht.hostnameWithProtocolPort","img"),actions:{removeGimg:function(){var a=this;this.set("deletingImg",!0);var b=this.get("img.src_path");$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeGimg",data:{img_path:b},success:function(b){a.setProperties({"img.img_visible":!1,deletingImg:!1}),alert(b)}})}}}),Exyht.ManagePostComponent=Ember.Component.extend({actions:{editPostTrue:function(){var a=this;this.setProperties({isEditingOnForPostTitle:!0,postIdForTypeBlogPost:this.get("id"),isEditingOnForTypeBlogPost:!0,isProfileEditingOnForTypeBlogPost:!1,editingOnForProfSetCtlr:!1,titleForTypeBlogPost:this.get("title")}),Ember.$.getJSON(Exyht.currentBaseUri+"/getOnlyPostBody/"+this.get("id")).then(function(b){Ember.run(function(){a.set("postBodyForTypeBlogPost",b.body);var c=a.get("postBodyForTypeBlogPost");"undefined"!==c||""!==c?a.sendAction("editPostTrue"):alert("No post body! or Could not fetch data! Maybe server error.")})})},viewComments:function(){this.set("titleForCommentsController",this.get("title")),this.sendAction("viewComments",this.get("id"))}}}),Exyht.ManageStatusComponent=Ember.Component.extend({loadingOn:!1,actions:{changeNameSubtitle:function(a,b){var c={};if(1===a){var d=this.get("blog_name");c={blog_name:d}}else if(2===a){var e=this.get("blog_subtitle");c={blog_subtitle:e}}this.set("loadingOn",!0);var f=this;return $.ajax({type:"POST",url:Exyht.BaseUrl+"/"+b,data:c,success:function(a){f.set("loadingOn",!1),console.log(a),alert(a)}})},changeBlogName:function(){this.send("changeNameSubtitle",1,"changeBlogName")},changeSubtitle:function(){this.send("changeNameSubtitle",2,"changeSubtitle")},changeModeFeature:function(a,b,c){return this.set(a,b),$.ajax({type:"POST",url:Exyht.BaseUrl+"/"+c,success:function(a){console.log(a),alert(a)}})},turnReadOnlyModeOn:function(){this.send("changeModeFeature","read_only_mode",!0,"turnReadOnlyModeOn")},turnReadOnlyModeOff:function(){this.send("changeModeFeature","read_only_mode",!1,"turnReadOnlyModeOff")},turnCommentFeatureOn:function(){this.send("changeModeFeature","has_cmnt_feature",!0,"turnCommentFeatureOn")},turnCommentFeatureOff:function(){this.send("changeModeFeature","has_cmnt_feature",!1,"turnCommentFeatureOff")},turnNavbarOn:function(){this.send("changeModeFeature","has_navbar",!0,"turnNavbarOn")},turnNavbarOff:function(){this.send("changeModeFeature","has_navbar",!1,"turnNavbarOff")},addNewLink:function(a){var b=this.get("link_name"),c=this.get("link_url");if(!b||!c)return!1;this.set("loadingOn",!0);var d=this;return $.ajax({type:"POST",url:Exyht.BaseUrl+"/"+a,data:{link_name:b,link_url:c},dataType:"json",success:function(a){d.set("loadingOn",!1),a.has_error===!1&&(d.set("link_name",""),d.set("link_url",""),d.get("blog_links").pushObject({link_name:b,link_url:c,status:!0,is_blog_url:!0})),console.log(a.message),alert(a.message)}})},addNavLink:function(){this.send("addNewLink","addNavLink")},addElseLink:function(){this.send("addNewLink","addElseLink")}}}),Exyht.ProfSettingComponent=Ember.Component.extend({isRemoved:!1,pwd_match:!0,too_small:!1,isRemovingPicture:!1,isProfileEditingOnForProfileSetting:!1,admin_token:function(){return Ember.get("Exyht.adminToken.token")}.property("Exyht.adminToken.token"),actions:{changePassword:function(){var a=this.get("old_password"),b=this.get("new_password"),c=this.get("confirm_password");if(a.length<5||b.length<5||c.length<5)return this.set("too_small",!0),!1;if(this.set("too_small",!1),b!=c)return this.set("pwd_match",!1),!1;this.set("pwd_match",!0);var d=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/changePassword",data:{old_password:a,new_password:b},success:function(a){console.log("Response: "+a),alert(a),d.setProperties({old_password:"",new_password:"",confirm_password:""})}})},editProfileTrue:function(){this.setProperties({isProfileEditingOnForProfileSetting:!0,isProfEditOnForTypeBlogPost:!0,aboutAdminForTypeBlogPost:this.get("about")}),this.transitionToRoute("typeblogpost")},removeProfPicture:function(){this.set("isRemovingPicture",!0);var a=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeProfileImage",success:function(b){console.log("Response: "+b),alert(b),a.setProperties({isRemoved:!0,isRemovingPicture:!1})}})},cancelUploadingImage:function(){$("#imgLoadingDiv").hide()}}}),Exyht.RemoveBloglinkComponent=Ember.Component.extend({actions:{removeLink:function(){var a=this.get("link.id");this.set("loadingOn",!0);var b=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeLink",data:{link_id:a},success:function(a){b.set("loadingOn",!1),b.set("link.status",!1),console.log(a),alert(a)}})}}}),Exyht.AutoExpandingTextAreaComponent=Ember.TextArea.extend({didInsertElement:function(){Ember.run.next(function(){function a(a){var c;c=a.match(/`{3,}/g),c&&c.length%2?b=!0:(c=a.match(/`/g),b=c&&c.length%2?!0:!1)}var b=!1;this.$().focus(),this.$().textcomplete([{match:/\B:([\-+\w]*)$/,search:function(a,b){b($.map(emojies,function(b){return 0===b.indexOf(a)?b:null}))},template:function(a){return new Ember.Handlebars.SafeString(emoji.replace_colons(":"+a.toLowerCase()+":")+" :"+a+":")},replace:function(a){return":"+a+": "},index:1,context:function(c){return a(c),!b}},{match:/\b(\w{2,})$/,search:function(a,b){b($.map(words,function(b){return 0===b.indexOf(a)?b:null}))},index:1,replace:function(a){return a+" "},context:function(){return b}}]),this.$().scroll(function(){var a=$(this).scrollTop();0===a?a=a:a+=10,$("div#postBodyDiv").stop().animate({scrollTop:a},500)})}.bind(this))}}),Exyht.ToprowNotificationComponent=Ember.Component.extend({notificationTemplate:function(a,b){return 0===a?'<div class="huge">No</div><div>'+b+"</div>":a>1?'<div class="huge">'+a+"</div><div>"+b+"s</div>":'<div class="huge">1</div><div>'+b+"</div>"},newCommentCount:function(){var a=this.get("newComment"),b=this.notificationTemplate(a,"New Comment");return new Ember.Handlebars.SafeString(b)}.property("newComment"),totalDraft:function(){var a,b=this.get("posts");return a="undefined"!=typeof b?this.notificationTemplate(b.filterBy("isDraft",!0).get("length"),"Draft"):this.notificationTemplate(0,"Draft"),new Ember.Handlebars.SafeString(a)}.property("posts.@each.isDraft"),flaggedCommentCount:function(){var a=this.get("flaggedComment"),b=this.notificationTemplate(a,"Flagged Comment");return new Ember.Handlebars.SafeString(b)}.property("flaggedComment")}),Exyht.RadioButton=Ember.Component.extend({tagName:"input",type:"radio",attributeBindings:["name","type","value","style"]}),Ember.Handlebars.helper("radio-button",Exyht.RadioButton),Exyht.UiSettingsComponent=Ember.Component.extend({favcolor:"",selectedCategory:"",selectedfs:"",categories:[{color:"Background Color",domArea:1},{color:"Navbar Color",domArea:2},{color:"Post Body Color",domArea:3},{color:"Sidebar Color",domArea:4},{color:"Footer Color",domArea:5},{color:"Link Color",domArea:6}],fstyles:[{name:"Serif",font_family:"font-family:serif"},{name:"Sans Serif",font_family:"font-family:sans-serif"},{name:"Rockwell",font_family:"font-family:Rockwell"},{name:"Courier New",font_family:"font-family:Courier New"},{name:"Palatino Linotype",font_family:"font-family:Palatino Linotype"},{name:"Trebuchet MS",font_family:"font-family:Trebuchet MS"},{name:"Papyrus",font_family:"font-family:Papyrus"},{name:"Impact",font_family:"font-family:Impact"},{name:"Segoe UI",font_family:"font-family:Segoe UI"},{name:"Calibri",font_family:"font-family:Calibri"},{name:"Times New Roman",font_family:"font-family:Times New Roman"}],actions:{changeColor:function(){var a=this.get("favcolor"),b=this.get("selectedCategory");$.ajax({type:"POST",url:Exyht.BaseUrl+"/changeColor",data:{favcolor:a,category:b},success:function(a){alert(a)}})},changeFontStyle:function(){var a=$("input:radio[name=fontType]:checked").val();console.log(a),$.ajax({type:"POST",url:Exyht.BaseUrl+"/changeFontFamily",data:{selectedFont:a},success:function(a){alert(a)}})}}}),Exyht.CommentController=Ember.ObjectController.extend({needs:"posttitle",title:""}),Exyht.PosttitleController=Ember.ObjectController.extend({needs:["typeblogpost","comment","profilesetting"],isEditingOnForPostTitle:!1,editingOnForProfSetCtlr:Ember.computed.alias("controllers.profilesetting.isProfileEditingOnForProfileSetting"),titleForCommentsController:Ember.computed.alias("controllers.comment.title"),isEditingOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isEditingOn"),isProfileEditingOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isProfileEditingOn"),postIdForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.postId"),titleForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.ntitle"),postBodyForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.nbody")}),Exyht.ProfilesettingController=Ember.ObjectController.extend({needs:"typeblogpost",isProfileEditingOnForProfileSetting:!1,isProfEditOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isProfileEditingOn"),aboutAdminForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.nbody")}),Exyht.TypeblogpostController=Ember.ObjectController.extend({needs:["posttitle","profilesetting"],isImageTab:!0,admin_token:Ember.computed.oneWay("controllers.profilesetting.admin_token"),editOnForProfSetContr:Ember.computed.alias("controllers.profilesetting.isProfileEditingOnForProfileSetting"),isProfileEditingOn:!1,isEditingOn:!1,postId:"",ntitle:"",nbody:"",showNbodyLength:!1,newBodyLength:""});