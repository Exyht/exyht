function showLoading(){var a=$("#loadingDiv");a.show()}function showImgLoading(){var a=$("#imgLoadingDiv");a.show()}window.Exyht=Ember.Application.create({}),Exyht.deferReadiness(),Exyht.BaseUrl="/blog/admin-page",Exyht.gravatarVersion="identicon",Exyht.currentBaseUri=window.location.protocol+"//"+window.location.hostname+Exyht.BaseUrl,$.ajaxSetup({headers:{"Admin-X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}}),Ember.Handlebars.helper("format-markdown",function(a){function b(a){return/^https?:\/\//.test(a)?a:void 0}if("undefined"!=typeof a){var c=new Markdown.getSanitizingConverter;return emoji.sheet_path=Exyht.PathToLibraries+"/libraries/js/sheet_twitter_72.png",emoji.use_sheet=!0,emoji.include_title=!0,emoji.init_env(),new Ember.Handlebars.SafeString(emoji.replace_colons(html_sanitize(c.makeHtml(a),b)))}}),Exyht.Router.map(function(){this.route("index",{path:Exyht.BaseUrl}),this.route("comments",{path:Exyht.BaseUrl+"/comments/:post_id"}),this.route("typeblogpost",{path:Exyht.BaseUrl+"/typeblogpost"}),this.route("profilesetting",{path:Exyht.BaseUrl+"/profilesetting"}),this.route("uisettings",{path:Exyht.BaseUrl+"/uisettings"})}),Exyht.Router.reopen({location:"history"}),Exyht.IndexRoute=Ember.Route.extend({model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"/getBlogPosts").then(function(a){return a})},redirect:function(){this.transitionTo("index")}}),Exyht.CommentsRoute=Ember.Route.extend({model:function(a){return Ember.$.getJSON(Exyht.currentBaseUri+"/getComments/"+a.post_id).then(function(a){return a})}}),Exyht.ProfilesettingRoute=Ember.Route.extend({model:function(){return Ember.$.getJSON(Exyht.currentBaseUri+"/getProfileInfo").then(function(a){return a})}}),Exyht.AutoExpandingTextAreaComponent=Ember.TextArea.extend({didInsertElement:function(){Ember.run.next(function(){function a(a){var c;c=a.match(/`{3,}/g),c&&c.length%2?b=!0:(c=a.match(/`/g),b=c&&c.length%2?!0:!1)}var b=!1;this.$().focus(),this.$().textcomplete([{match:/\B:([\-+\w]*)$/,search:function(a,b){b($.map(emojies,function(b){return 0===b.indexOf(a)?b:null}))},template:function(a){return emoji.sheet_path=Exyht.PathToLibraries+"/libraries/js/sheet_twitter_72.png",emoji.use_sheet=!0,emoji.include_title=!0,emoji.init_env(),new Ember.Handlebars.SafeString(emoji.replace_colons(":"+a.toLowerCase()+":")+" :"+a+":")},replace:function(a){return":"+a+": "},index:1,context:function(c){return a(c),!b}},{match:/\b(\w{2,})$/,search:function(a,b){b($.map(words,function(b){return 0===b.indexOf(a)?b:null}))},index:1,replace:function(a){return a+" "},context:function(){return b}}]),this.$().scroll(function(){var a=$(this).scrollTop();0===a?a=a:a+=10,$("div#postBodyDiv").stop().animate({scrollTop:a},500)})}.bind(this))}}),Exyht.IndexController=Ember.ObjectController.extend({loadingOn:!1,actions:{changeNameSubtitle:function(a,b){var c={};if(1===a){var d=this.get("blog_name");c={blog_name:d}}else if(2===a){var e=this.get("blog_subtitle");c={blog_subtitle:e}}this.set("loadingOn",!0);var f=this;return $.ajax({type:"POST",url:Exyht.BaseUrl+"/"+b,data:c,success:function(a){f.set("loadingOn",!1),console.log(a),alert(a)}})},changeBlogName:function(){this.send("changeNameSubtitle",1,"changeBlogName")},changeSubtitle:function(){this.send("changeNameSubtitle",2,"changeSubtitle")},changeModeFeature:function(a,b,c){return this.set(a,b),$.ajax({type:"POST",url:Exyht.BaseUrl+"/"+c,success:function(a){console.log(a),alert(a)}})},turnReadOnlyModeOn:function(){this.send("changeModeFeature","read_only_mode",!0,"turnReadOnlyModeOn")},turnReadOnlyModeOff:function(){this.send("changeModeFeature","read_only_mode",!1,"turnReadOnlyModeOff")},turnCommentFeatureOn:function(){this.send("changeModeFeature","has_cmnt_feature",!0,"turnCommentFeatureOn")},turnCommentFeatureOff:function(){this.send("changeModeFeature","has_cmnt_feature",!1,"turnCommentFeatureOff")},turnNavbarOn:function(){this.send("changeModeFeature","has_navbar",!0,"turnNavbarOn")},turnNavbarOff:function(){this.send("changeModeFeature","has_navbar",!1,"turnNavbarOff")},addNewLink:function(a){var b=this.get("link_name"),c=this.get("link_url");if(!b||!c)return!1;this.set("loadingOn",!0);var d=this;return $.ajax({type:"POST",url:Exyht.BaseUrl+"/"+a,data:{link_name:b,link_url:c},dataType:"json",success:function(a){d.set("loadingOn",!1),a.has_error===!1&&(d.set("link_name",""),d.set("link_url",""),d.get("blog_links").pushObject({link_name:b,link_url:c,status:!0,is_blog_url:!0})),console.log(a.message),alert(a.message)}})},addNavLink:function(){this.send("addNewLink","addNavLink")},addElseLink:function(){this.send("addNewLink","addElseLink")}}}),Exyht.ApplicationController=Ember.ObjectController.extend({actions:{logOut:function(){$.post(Exyht.BaseUrl+"/logout",function(a){"true"===a&&window.location.replace(Exyht.BaseUrl+"/login")})}}}),Exyht.BloglinkController=Ember.ObjectController.extend({actions:{removeLink:function(){var a=this.get("id");this.set("loadingOn",!0);var b=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeLink",data:{link_id:a},success:function(a){b.set("loadingOn",!1),b.set("status",!1),console.log(a),alert(a)}})}}}),Exyht.CommentsController=Ember.ArrayController.extend({needs:"posttitle",title:""}),Exyht.CommentController=Ember.ObjectController.extend({banLoading:!1,flagLoading:!1,actions:{markAsSeen:function(){var a=this.get("model.id");this.set("isSeen",!0),$.ajax({type:"POST",url:Exyht.BaseUrl+"/markAsSeen/"+a,success:function(a){console.log("Marked as seen!"),alert(a)}})},removeComment:function(){this.set("showLoading",!0);var a=confirm("Want to remove?");if(a===!0){var b=this.get("model.id"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeComment/"+b,success:function(a){console.log(a),c.set("showLoading",!1),c.set("isFlagged",!1),c.set("status",!1),alert(a)}})}else this.set("showLoading",!1)},banIp:function(){this.set("banLoading",!0);var a=confirm("Want to ban this Ip address?");if(a===!0){var b=this.get("ip_address"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/banIp/"+b,success:function(a){console.log(a),c.set("banLoading",!1),c.set("ip_status",!0),alert(a)}})}else this.set("banLoading",!1)},removeFlag:function(){this.set("flagLoading",!0);var a=confirm("Want to remove flag?");if(a===!0){var b=this.get("id"),c=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeFlag/"+b,success:function(a){console.log(a),c.set("flagLoading",!1),c.set("isFlagged",!1),alert(a)}})}else this.set("flagLoading",!1)}}}),Exyht.PosttitleController=Ember.ObjectController.extend({needs:["typeblogpost","comments","profilesetting"],isEditingOnForPostTitle:!1,editingOnForProfSetCtlr:Ember.computed.alias("controllers.profilesetting.isProfileEditingOnForProfileSetting"),titleForCommentsController:Ember.computed.alias("controllers.comments.title"),isEditingOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isEditingOn"),isProfileEditingOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isProfileEditingOn"),postIdForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.postId"),titleForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.ntitle"),postBodyForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.nbody"),actions:{editPostTrue:function(){this.set("isEditingOnForPostTitle",!0),this.set("postIdForTypeBlogPost",this.get("model.id")),this.set("isEditingOnForTypeBlogPost",!0),this.set("isProfileEditingOnForTypeBlogPost",!1),this.set("editingOnForProfSetCtlr",!1),this.set("titleForTypeBlogPost",this.get("model.title"));var a=this;Ember.$.getJSON(Exyht.currentBaseUri+"/getOnlyPostBody/"+this.get("model.id")).then(function(b){Ember.run(function(){a.set("postBodyForTypeBlogPost",b.body),a.transitionToRoute("typeblogpost")})})},viewComments:function(){this.set("titleForCommentsController",this.get("model.title")),this.transitionToRoute("comments",this.get("model.id"))}}}),Exyht.ProfilesettingController=Ember.ObjectController.extend({needs:"typeblogpost",admin_token:function(){return Ember.get("Exyht.adminToken.token")}.property("Exyht.adminToken.token"),isProfileEditingOnForProfileSetting:!1,isRemovingPicture:!1,isRemoved:!1,pwd_match:!0,too_small:!1,isProfEditOnForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.isProfileEditingOn"),aboutAdminForTypeBlogPost:Ember.computed.alias("controllers.typeblogpost.nbody"),actions:{changePassword:function(){var a=this.get("old_password"),b=this.get("new_password"),c=this.get("confirm_password");if(a.length<5||b.length<5||c.length<5)return this.set("too_small",!0),!1;if(this.set("too_small",!1),b!=c)return this.set("pwd_match",!1),!1;this.set("pwd_match",!0);var d=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/changePassword",data:{old_password:a,new_password:b},success:function(a){console.log("Response: "+a),alert(a),d.set("old_password",""),d.set("new_password",""),d.set("confirm_password","")}})},editProfileTrue:function(){this.set("isProfileEditingOnForProfileSetting",!0),this.set("isProfEditOnForTypeBlogPost",!0),this.set("aboutAdminForTypeBlogPost",this.get("model.about")),this.transitionToRoute("typeblogpost")},removeProfPicture:function(){this.set("isRemovingPicture",!0);var a=this;$.ajax({type:"POST",url:Exyht.BaseUrl+"/removeProfileImage",success:function(b){console.log("Response: "+b),alert(b),a.set("isRemoved",!0),a.set("isRemovingPicture",!1)}})},cancelUploadingImage:function(){$("#imgLoadingDiv").hide()}}}),Exyht.ToprowController=Ember.ObjectController.extend({notificationTemplate:function(a,b){return 0===a?'<div class="huge">No</div><div>'+b+"</div>":a>1?'<div class="huge">'+a+"</div><div>"+b+"s</div>":'<div class="huge">1</div><div>'+b+"</div>"},newCommentCount:function(){var a=this.get("model.newComment"),b=this.notificationTemplate(a,"New Comment");return new Ember.Handlebars.SafeString(b)}.property("model.newComment"),totalDraft:function(){var a,b=this.get("model.posts");return a="undefined"!=typeof b?this.notificationTemplate(b.filterBy("isDraft",!0).get("length"),"Draft"):this.notificationTemplate(0,"Draft"),new Ember.Handlebars.SafeString(a)}.property("model.posts.@each.isDraft"),flaggedCommentCount:function(){var a=this.get("model.flaggedComment"),b=this.notificationTemplate(a,"Flagged Comment");return new Ember.Handlebars.SafeString(b)}.property("model.flaggedComment")}),Exyht.TypeblogpostController=Ember.ObjectController.extend({needs:["posttitle","profilesetting"],admin_token:Ember.computed.oneWay("controllers.profilesetting.admin_token"),editOnForProfSetContr:Ember.computed.alias("controllers.profilesetting.isProfileEditingOnForProfileSetting"),isProfileEditingOn:!1,isEditingOn:!1,isSavingAsDraft:!1,isPublishing:!1,postId:"",ntitle:"",nbody:"",showNbodyLength:!1,newBodyLength:"",status:[{postStatus:"Publish",id:1},{postStatus:"Draft",id:0}],currentStatus:{id:1},postKey:function(){var a=this.get("nbody").length,b=Math.abs(20-a);0===a||20>a?this.set("showNbodyLength",!0):this.set("showNbodyLength",!1),this.set("newBodyLength",b)}.observes("nbody"),actions:{createPost:function(a,b){var c=this.get("ntitle"),d=this.get("nbody");this.set(a,!0);var e=this;return!c||c.length<5||!d||d.length<20?!1:(console.log("Request: Sending request"),$.ajax({type:"POST",url:Exyht.BaseUrl+"/"+b,data:{title:c,body:d},success:function(b){console.log("Response: "+b),e.set(a,!1),e.set("ntitle",""),e.set("nbody",""),alert(b)}}))},createNew:function(){this.send("createPost","isPublishing","createNewPost")},createDraft:function(){this.send("createPost","isSavingAsDraft","createNewDraft")},saveProfileEdit:function(){var a=this.get("nbody");console.log("Request: Sending request"),$.ajax({type:"POST",url:Exyht.BaseUrl+"/saveProfileEdit",data:{about:a},success:function(a){console.log("Response: "+a),alert(a)}})},cancelProfileEditing:function(){this.set("isProfileEditingOn",!1),this.set("isEditingOn",!1),this.set("ntitle",""),this.set("nbody",""),this.set("postId",""),this.set("editOnForProfSetContr",!1)},saveEdit:function(a){var b=this.get("ntitle"),c=this.get("nbody"),d=this.get("currentStatus.id");return!b||this.get("ntitle").length<5||!c||this.get("nbody").length<20?!1:void $.ajax({type:"POST",url:Exyht.BaseUrl+"/saveEdit",data:{postId:a,title:b,body:c,status:d},success:function(a){console.log("Response: "+a),alert(a)}})},cancelEditing:function(){this.set("isEditingOn",!1),this.set("ntitle",""),this.set("nbody",""),this.set("postId","")},insertBold:function(){var a=$("textarea");a.val(a.val()+" **bold** ")},insertItalic:function(){var a=$("textarea");a.val(a.val()+" *italic* ")},insertLink:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"[Link description](http://example.com)":a.val()+"\n [Link description](http://example.com)")},insertQuote:function(){var a=$("textarea");a.val(a.val()+"\n > your quote here")},insertCode:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"`For inline code` \n\n	For pre code":a.val()+"\n\n`For inline code` \n\n	For pre code")},insertImage:function(){var a=$("textarea"),b=$("#imageUrlTextField");a.val(""===b.val()?a.val()+"![alt text](http://example.com/image.jpg)":a.val()+"![alt text]("+b.val()+")")},cancelUploadImage:function(){$("#loadingDiv").hide()},insertOrderedlist:function(){var a=$("textarea");a.val(a.val()+"Indent one space after the dot '.'\n\n1. Ordered list1\n2. Ordered list2")},insertUnorderedlist:function(){var a=$("textarea");a.val(a.val()+"Indent one space after the + or -.\n\n- Unordered list1\n	+ Nested list")},insertHorizontalrule:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"-----\nNew line":a.val()+"\n\n-----\nNew line")},insertStrikethrough:function(){var a=$("textarea");a.val(a.val()+"<del>Strike through</del>")},insertSubscript:function(){var a=$("textarea");a.val(a.val()+"Sub<sub>script</sub>")},insertSuperscript:function(){var a=$("textarea");a.val(a.val()+"Sub<sup>script</sup>")},insertHeading1:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"# Heading1\n":a.val()+"\n# Heading1\n")},insertHeading2:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"## Heading2\n":a.val()+"\n## Heading2\n")},insertHeading3:function(){var a=$("textarea");a.val(""===a.val()?a.val()+"### Heading3\n":a.val()+"\n### Heading3\n")},resetTextarea:function(){var a=$("textarea");a.val("")}}}),Exyht.RadioButton=Ember.Component.extend({tagName:"input",type:"radio",attributeBindings:["name","type","value","style"]}),Ember.Handlebars.helper("radio-button",Exyht.RadioButton),Exyht.UisettingsController=Ember.ObjectController.extend({favcolor:"",selectedCategory:"",selectedfs:"",categories:[{color:"Background Color",domArea:1},{color:"Navbar Color",domArea:2},{color:"Post Body Color",domArea:3},{color:"Sidebar Color",domArea:4},{color:"Footer Color",domArea:5},{color:"Link Color",domArea:6}],fstyles:[{name:"Serif",font_family:"font-family:serif"},{name:"Sans Serif",font_family:"font-family:sans-serif"},{name:"Rockwell",font_family:"font-family:Rockwell"},{name:"Courier New",font_family:"font-family:Courier New"},{name:"Palatino Linotype",font_family:"font-family:Palatino Linotype"},{name:"Trebuchet MS",font_family:"font-family:Trebuchet MS"},{name:"Papyrus",font_family:"font-family:Papyrus"},{name:"Impact",font_family:"font-family:Impact"},{name:"Segoe UI",font_family:"font-family:Segoe UI"},{name:"Calibri",font_family:"font-family:Calibri"},{name:"Times New Roman",font_family:"font-family:Times New Roman"}],actions:{changeColor:function(){var a=this.get("favcolor"),b=this.get("selectedCategory");$.ajax({type:"POST",url:Exyht.BaseUrl+"/changeColor",data:{favcolor:a,category:b},success:function(a){alert(a)}})},changeFontStyle:function(){var a=$("input:radio[name=fontType]:checked").val();console.log(a),$.ajax({type:"POST",url:Exyht.BaseUrl+"/changeFontFamily",data:{selectedFont:a},success:function(a){alert(a)}})}}}),Exyht.CommentView=Ember.View.extend({templateName:"comment",cgravatarUrl:function(){return"http://www.gravatar.com/avatar/"+this.get("controller.gravatarUri")+"?d="+Exyht.gravatarVersion+"&s=30"}.property("controller.gravatarUri")}),Exyht.IndexView=Ember.View.extend({templateName:"index",numberOfPost:function(){var a,b=this.get("controller.posts.length");return a=1===b?"1 Post":b>1?b+" Posts":"No Post"}.property("controller.posts.length")});