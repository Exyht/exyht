<!DOCTYPE html>
<html>
<head>
<script src="//code.jquery.com/jquery.min.js"></script>
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <meta charset="utf-8">
  <title>Ember Starter Kit</title>
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.1/normalize.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.0.4/jquery.imagesloaded.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/masonry/3.2.2/masonry.pkgd.min.js"></script>
  <script src="http://builds.handlebarsjs.com.s3.amazonaws.com/handlebars-v2.0.0.js"></script>
  <script src="http://builds.emberjs.com/tags/v1.9.1/ember.js"></script>
  <style>
  /* Put your CSS here */
  html, body {
    margin: 20px;
  }
  .item { width: 28%; min-width: 200px; }

  .thumb {
    margin-bottom: 2%;
  }
  </style>
</head>
<body>

  <script type="text/x-handlebars" data-template-name="application">
    <h2>Welcome to Exyht</h2>
    {{outlet}}
  </script>

  <script type="text/x-handlebars" data-template-name="index">
    <div id="galleryContainer">
    {{#each img in images}}
      <div class="item thumb">
      {{#if img.img_visible}}
        <img {{bind-attr src=img.src_path}} class="img-thumbnail"/>
      {{/if}}
      </div>
    {{/each}}
    </div>
  </script>
  <script>
  App = Ember.Application.create();

App.IndexRoute = Ember.Route.extend({
  model: function(){
    return {
     images: [
      {
       name: "Read only mode on",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5836185/4fc9ef82-a19c-11e4-9191-9ec4cada5eee.jpg",
       img_visible: true
      },
      {
       name: "Awesome editor",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5836201/6c796194-a19c-11e4-9338-dd6444f405e5.jpg",
       img_visible: true
      },
      {
       name: "Customize color & font",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5836204/739bc4a8-a19c-11e4-9b7b-202ce6ea453a.jpg",
       img_visible: true
      },
      {
       name: "Manage blog status",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5938685/a3d9caf8-a727-11e4-9726-d22ae1eabdb1.jpg",
       img_visible: true
      },
      {
       name: "Upload image & Insert video",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5938695/bd8b0796-a727-11e4-9d84-b6fed214dfea.jpg",
       img_visible: true
      },
      {
       name: "notification",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5938701/ca6f177c-a727-11e4-88fc-98298a5b7f47.jpg",
       img_visible: true
      },
      {
       name: "Installer",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5938710/d8e239b0-a727-11e4-819e-c4c4e97db940.jpg",
       img_visible: true
      },
      {
       name: "During Installing process",
       src_path: "https://cloud.githubusercontent.com/assets/9896315/5938726/e9af04e4-a727-11e4-8374-8a9062d1d837.jpg",
       img_visible: true
      }
     ]
    };
  }
});

App.IndexView = Ember.View.extend({

  templateName: "index",

  didInsertElement: function(){
    this.scheduleMasonry();
  },

  willDestroyElement: function(){
    this.destroyMasonry();
  },

  scheduleMasonry: (function(){
    Ember.run.scheduleOnce('afterRender', this, this.applyMasonry);
  }).observes('controller.images.@each'),

  applyMasonry: function(){
    var $galleryContainer = $('#galleryContainer');
    $galleryContainer.imagesLoaded(function() {
        // check if masonry is initialized
        var msnry = $galleryContainer.data('masonry');
        if ( msnry ) {
          msnry.reloadItems();
          // disable transition
          var transitionDuration = msnry.options.transitionDuration;
          msnry.options.transitionDuration = 0;
          msnry.layout();
          // reset transition
          msnry.options.transitionDuration = transitionDuration;
        } else {
          // init masonry
          $galleryContainer.masonry({
            itemSelector: '.item',
            columnWidth: 200
          });
        }
    });
  },
  
  destroyMasonry: function(){
    $('#galleryContainer').masonry('destroy');
  }
});
  </script>
</body>
</html>
